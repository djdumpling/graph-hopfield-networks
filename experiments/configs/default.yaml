# Default experiment configuration for Graph Hopfield Networks

# Dataset configuration
dataset:
  name: "cora"  # cora, citeseer, pubmed
  root: "./data"
  normalize_features: true

# Model configuration
model:
  name: "ghn"  # ghn, gcn, gat, graphsage, mlp
  hidden_dim: 64
  num_patterns: 64  # For GHN only
  beta: 1.0  # For GHN only - initial beta (learnable by default)
  lambda_graph: 0.3  # For GHN only
  num_iterations: 4  # For GHN only
  alpha: 0.3  # For GHN only
  num_layers: 2  # more is better
  dropout: 0.5
  # New GHN parameters
  tie_keys_values: false  # Untied keys/values for better capacity
  learnable_beta: true  # Learn inverse temperature
  use_spectral_norm_constraint: true  # Constrain beta for convexity
  norm_mode: "per_layer"  # "per_layer" preserves energy descent, "per_iteration" is legacy
  use_query_proj: true  # Add learnable query projection for better matching
  # Diversity regularization to prevent pattern collapse
  diversity_loss_weight: 0.01  # Weight for diversity loss (0 = disabled)
  diversity_threshold: 0.5  # Patterns with similarity > threshold are penalized

# Training configuration
training:
  epochs: 200
  lr: 0.01
  weight_decay: 0.001
  patience: 50  # Early stopping patience
  min_delta: 0.001  # Minimum improvement for early stopping

# Corruption configuration (for evaluation)
corruption:
  type: "feature_noise"  # feature_noise, feature_mask, edge_drop, edge_add, label_flip
  levels: [0.0, 0.1, 0.2, 0.3, 0.4, 0.5]

# Experiment configuration
experiment:
  num_seeds: 5
  device: "auto"  # auto, cpu, cuda
  save_results: true
  results_dir: "./results"
