# Default experiment configuration for Graph Hopfield Networks
# Optimized to outperform GCN on node classification (target: >81.5% on Cora)

# Dataset configuration
dataset:
  name: "cora"  # cora, citeseer, pubmed
  root: "./data"
  normalize_features: true

# Model configuration
model:
  name: "ghn"  # ghn, gcn, gat, graphsage, mlp
  hidden_dim: 64
  num_layers: 2

  # === Hopfield Memory Configuration ===
  num_patterns: 64  # Memory bank size (K patterns)
  beta: 2.0  # Initial inverse temperature (higher = sharper attention)
  learnable_beta: true  # Learn optimal temperature during training
  use_spectral_norm_constraint: true  # Constrain beta * ||M||^2 < 1 for convexity

  # === Keys/Values Configuration ===
  tie_keys_values: false  # Untied K/V for better memory capacity
  use_query_proj: true  # Learnable query projection for better matching

  # === Multi-Head Configuration ===
  num_heads: 4  # Multiple attention heads (like GAT)

  # === Iteration Configuration ===
  num_iterations: 3  # Hopfield iterations per layer
  alpha: 0.5  # Damping coefficient for update stability

  # === Graph Configuration ===
  lambda_graph: 0.2  # Graph Laplacian regularization weight

  # === Normalization ===
  norm_mode: "per_layer"  # Apply LayerNorm once after all iterations (preserves energy descent)

  # === Skip Connections ===
  use_skip_connections: true  # Inter-layer skip connections
  skip_weight: 0.1  # Weight for skip connections

  # === Diversity Regularization ===
  diversity_loss_weight: 0.01  # Prevent pattern collapse
  diversity_threshold: 0.5  # Penalize patterns with similarity > threshold

  # === Regularization ===
  dropout: 0.5

# Training configuration
training:
  epochs: 200
  lr: 0.01
  weight_decay: 0.0005  # Reduced from 0.001 for better generalization
  patience: 50  # Early stopping patience
  min_delta: 0.001  # Minimum improvement for early stopping

# Corruption configuration (for robustness evaluation)
corruption:
  type: "feature_noise"  # feature_noise, feature_mask, edge_drop, edge_add, label_flip
  levels: [0.0, 0.1, 0.2, 0.3, 0.4, 0.5]

# Experiment configuration
experiment:
  num_seeds: 5
  device: "auto"  # auto, cpu, cuda
  save_results: true
  results_dir: "./results"
